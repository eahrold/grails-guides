<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>3 Configuring GORM for GraphQL</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/guide.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />            
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Grails Framework Guide 
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/training.html"><strong>1</strong><span>Training</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/configuringGormGraphQL.html"><strong>3</strong><span>Configuring GORM for GraphQL</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/playGraphQL.html"><strong>4</strong><span>Playing with the GraphQL browser</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/installApollo.html"><strong>5</strong><span>Install and Configure Apollo</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/queryGraphQL.html"><strong>6</strong><span>Querying GraphQL</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/mutations.html"><strong>7</strong><span>Mutations</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/conclusion.html"><strong>8</strong><span>Conclusion</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/helpWithGrails.html"><strong>9</strong><span>Help with Grails</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/gettingStarted.html">&lt;&lt; <strong>2</strong><span>Getting Started</span></a></div>
                

                
                    <div class="toc-item next-right"><a href="../guide/playGraphQL.html"><strong>4</strong><span>Playing with the GraphQL browser</span> >></a></div>
                


                

                

<h1 id="configuringGormGraphQL">3 Configuring GORM for GraphQL</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo/edit/master/src/main/docs/guide/configuringGormGraphQL.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Install the <a href="https://grails.github.io/gorm-graphql/latest/guide/index.html">GORM GraphQL</a> plugin by adding this line to the <code>dependencies</code> section in <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails:gorm-graphql:1.0.2</span><span class="delimiter">&quot;</span></span>
compile <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails.plugins:gorm-graphql:1.0.2</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, to generate a GraphQL schema for your domain classes, all that is needed is to add a <code>static graphql</code> property to the domain class in question.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/com/objectcomputing/Talk.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="reserved">package</span> com.objectcomputing

<span class="reserved">import</span> grails.rest.Resource

<span class="error">@</span>Resource(uri=<span class="string"><span class="delimiter">'</span><span class="content">/talk</span><span class="delimiter">'</span></span>)
<span class="reserved">class</span> Talk {

    String title
    <span class="reserved">int</span> duration

    <span class="reserved">static</span> graphql = <span class="predefined-constant">true</span> <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="reserved">static</span> belongsTo = [speaker: Speaker]
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This will cause a GraphQL schema to be generated based on the properties in the domain class, following the constraints specified in the <code>constraints</code> block.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need to customize the behavior of the GraphQL schema, you can assign the <code>graphql</code> property to a custom <code>GraphQLMapping</code>, using the DSL provided by the plugin. This is not a requirement for this guide, however a few of the supported options are shown in the <code>Speaker</code> domain class.</p>
</div>
<div class="listingblock">
<div class="title">grails-app/domain/com/objectcomputing/Speaker.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="reserved">package</span> com.objectcomputing

<span class="reserved">import</span> grails.rest.Resource
<span class="reserved">import</span> org.grails.gorm.graphql.entity.dsl.GraphQLMapping
<span class="reserved">import</span> java.time.LocalDate
<span class="reserved">import</span> java.time.Period

<span class="error">@</span>Resource(uri=<span class="string"><span class="delimiter">'</span><span class="content">/speaker</span><span class="delimiter">'</span></span>)
<span class="reserved">class</span> Speaker {

    String firstName
    String lastName
    String name
    String email
    String bio
    LocalDate birthday

    <span class="reserved">static</span> hasMany = [talks: Talk]

    <span class="reserved">static</span> graphql = GraphQLMapping.build {

        property <span class="string"><span class="delimiter">'</span><span class="content">lastName</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="integer">1</span> <i class="conum" data-value="1"></i><b>(1)</b>
        property <span class="string"><span class="delimiter">'</span><span class="content">firstName</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="integer">2</span>
        property <span class="string"><span class="delimiter">'</span><span class="content">email</span><span class="delimiter">'</span></span>, <span class="key">order</span>: <span class="integer">3</span>

        exclude <span class="string"><span class="delimiter">'</span><span class="content">birthday</span><span class="delimiter">'</span></span> <i class="conum" data-value="2"></i><b>(2)</b>

        property <span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="key">deprecationReason</span>: <span class="string"><span class="delimiter">'</span><span class="content">To be removed August 1st, 2020</span><span class="delimiter">'</span></span> <i class="conum" data-value="3"></i><b>(3)</b>

        property(<span class="string"><span class="delimiter">'</span><span class="content">bio</span><span class="delimiter">'</span></span>) { <i class="conum" data-value="4"></i><b>(4)</b>
            order <span class="integer">4</span>
            dataFetcher { Speaker speaker -&gt;
                speaker.bio ?: <span class="string"><span class="delimiter">&quot;</span><span class="content">No biography provided</span><span class="delimiter">&quot;</span></span>
            }
        }

        add(<span class="string"><span class="delimiter">'</span><span class="content">age</span><span class="delimiter">'</span></span>, Integer) { <i class="conum" data-value="5"></i><b>(5)</b>
            dataFetcher { Speaker speaker -&gt;
                Period.between(speaker.birthday, LocalDate.now()).years
            }
            input <span class="predefined-constant">false</span>
        }
    }

    <span class="reserved">static</span> constraints = {
        email nullable: <span class="predefined-constant">true</span>, <span class="key">email</span>: <span class="predefined-constant">true</span>
        birthday nullable: <span class="predefined-constant">true</span>
        bio nullable: <span class="predefined-constant">true</span>
    }

    <span class="reserved">static</span> mapping = {
        bio type: <span class="string"><span class="delimiter">'</span><span class="content">text</span><span class="delimiter">'</span></span>
        name formula: <span class="string"><span class="delimiter">'</span><span class="content">concat(FIRST_NAME,</span><span class="char">\'</span><span class="content"> </span><span class="char">\'</span><span class="content">,LAST_NAME)</span><span class="delimiter">'</span></span>
        talks sort: <span class="string"><span class="delimiter">'</span><span class="content">id</span><span class="delimiter">'</span></span>
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Set property ordering</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Exclude property from the schema</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Deprecate a property (can also be set to <code>deprecated: true</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Custom data fetcher, for providing custom logic when retrieving the property</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Adding a (non persistent) property to the GraphQL schema</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can learn all the available features of the GORM GraphQL plugin <a href="https://grails.github.io/gorm-graphql/snapshot/guide/index.html">from the plugin documentation</a>.
</td>
</tr>
</table>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/gettingStarted.html">&lt;&lt; <strong>2</strong><span>Getting Started</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/playGraphQL.html"><strong>4</strong><span>Playing with the GraphQL browser</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title" style="text-align: right"><a href="https://travis-ci.org/grails-guides/gorm-graphql-with-react-and-apollo"><img src="https://travis-ci.org/grails-guides/gorm-graphql-with-react-and-apollo.svg?branch=master" /></a></div>            
                 <div class="local-title">
                    <a href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo">
                    <svg height="35" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="35" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></a> &nbsp;&nbsp;Get the Code
                </div>
                <div class="menu">
                    <div class="input-group">                        
                        <button href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/gorm-graphql-with-react-and-apollo.git'" class="codeButton">SSH</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/gorm-graphql-with-react-and-apollo.git'" class="codeButton">HTTPS</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/gorm-graphql-with-react-and-apollo'" class="codeButton">Subversion</button>
                    </div>
       
                    <div class="input-group">                    
                        <!-- Target -->
                        <input id="github-url" value="git@github.com:grails-guides/gorm-graphql-with-react-and-apollo.git" type="text" />

                        <!-- Trigger -->
                        <button class="clipbtn" type="button" data-clipboard-target="#github-url">

                            <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
                        </button>       

                    </div>
                    <div class="input-group">
                      <a href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo/archive/master.zip" class="downloadButton">Download ZIP</a>
                    </div>
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing. 
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
