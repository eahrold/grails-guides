<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>5 Install and Configure Apollo</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/guide.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />            
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        Grails Framework Guide 
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/training.html"><strong>1</strong><span>Training</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>Getting Started</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/configuringGormGraphQL.html"><strong>3</strong><span>Configuring GORM for GraphQL</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/playGraphQL.html"><strong>4</strong><span>Playing with the GraphQL browser</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/installApollo.html"><strong>5</strong><span>Install and Configure Apollo</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/queryGraphQL.html"><strong>6</strong><span>Querying GraphQL</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/mutations.html"><strong>7</strong><span>Mutations</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/conclusion.html"><strong>8</strong><span>Conclusion</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/helpWithGrails.html"><strong>9</strong><span>Help with Grails</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/playGraphQL.html">&lt;&lt; <strong>4</strong><span>Playing with the GraphQL browser</span></a></div>
                

                
                    <div class="toc-item next-right"><a href="../guide/queryGraphQL.html"><strong>6</strong><span>Querying GraphQL</span> >></a></div>
                


                

                

<h1 id="installApollo">5 Install and Configure Apollo</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo/edit/master/src/main/docs/guide/installApollo.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Now that you have a GraphQL schema, it is time to replace the existing RESTful integration in the React app using GraphQL. Of course we could compose GraphQL queries manually, however in most cases you will be better served by using a library to abstract away the details of making these requests. One option is the <a href="https://facebook.github.io/relay/">Relay framework</a>, which is developed by Facebook (the creators of React). Another popular library is <a href="https://www.apollographql.com/">Apollo</a>, which offers bindings for numerous JavaScript frameworks, including Angular and React. This guide will be using Apollo in the following steps.</p>
</div>
<div class="paragraph">
<p>Install the necessary packages using either <code>npm</code> or <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">~ npm install apollo-client-preset react-apollo graphql-tag graphql --save</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first requirement to use Apollo is to configure a <strong>provider</strong>, which will encapsulate the details needed to actual make requests to the GraphQL schema. Edit the file <code>src/main/webapp/index.js</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="title">client/src/index.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="reserved">import</span> React from <span class="string"><span class="delimiter">'</span><span class="content">react</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> ReactDOM from <span class="string"><span class="delimiter">'</span><span class="content">react-dom</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> App from <span class="string"><span class="delimiter">'</span><span class="content">./App</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> <span class="string"><span class="delimiter">'</span><span class="content">./css/bootstrap.css</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> <span class="string"><span class="delimiter">'</span><span class="content">./css/App.css</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> <span class="string"><span class="delimiter">'</span><span class="content">./css/grails.css</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> <span class="string"><span class="delimiter">'</span><span class="content">./css/main.css</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> {ApolloProvider} from <span class="string"><span class="delimiter">'</span><span class="content">react-apollo</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> {ApolloClient} from <span class="string"><span class="delimiter">'</span><span class="content">apollo-client</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> {createHttpLink} from <span class="string"><span class="delimiter">'</span><span class="content">apollo-link-http</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> {InMemoryCache} from <span class="string"><span class="delimiter">'</span><span class="content">apollo-cache-inmemory</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { SERVER_URL} from <span class="string"><span class="delimiter">&quot;</span><span class="content">./config</span><span class="delimiter">&quot;</span></span>;

<i class="conum" data-value="1"></i><b>(1)</b>
const client = <span class="keyword">new</span> ApolloClient({
  <span class="key">link</span>: createHttpLink({ <span class="key">uri</span>: <span class="error">`</span><span class="predefined">$</span>{SERVER_URL}/graphql<span class="error">`</span> }), <i class="conum" data-value="2"></i><b>(2)</b>
  <span class="key">cache</span>: <span class="keyword">new</span> InMemoryCache()
});

<i class="conum" data-value="3"></i><b>(3)</b>
ReactDOM.render(&lt; ApolloProvider client={client}&gt;
  <span class="tag">&lt;App</span> <span class="tag">/&gt;</span>
&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">ApolloProvider&gt;, document.getElementById('root'));</span></span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We create an instance of <code>ApolloClient</code>, which requires two objects - an <code>HttpLink</code> (which represents the URL of the GraphQL schema) and a cache store.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This client will send queries to the <code>${SERVER_URL}/graphql</code> endpoint - which conveniently happens to be where the GORM GraphQL plugin exposes the GraphQL schema</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Finally, we wrap our <code>App</code> component with an <code>ApolloProvider</code> component, passing our <code>ApolloClient</code> instance as a prop to the latter. Now all child components will be able to query/mutate the GraphQL schema pointed to by the <code>client</code>.</td>
</tr>
</table>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/playGraphQL.html">&lt;&lt; <strong>4</strong><span>Playing with the GraphQL browser</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/queryGraphQL.html"><strong>6</strong><span>Querying GraphQL</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title" style="text-align: right"><a href="https://travis-ci.org/grails-guides/gorm-graphql-with-react-and-apollo"><img src="https://travis-ci.org/grails-guides/gorm-graphql-with-react-and-apollo.svg?branch=master" /></a></div>            
                 <div class="local-title">
                    <a href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo">
                    <svg height="35" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="35" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg></a> &nbsp;&nbsp;Get the Code
                </div>
                <div class="menu">
                    <div class="input-group">                        
                        <button href="#" onclick="document.getElementById('github-url').value='git@github.com:grails-guides/gorm-graphql-with-react-and-apollo.git'" class="codeButton">SSH</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/gorm-graphql-with-react-and-apollo.git'" class="codeButton">HTTPS</button>
                        <button onclick="document.getElementById('github-url').value='https://github.com/grails-guides/gorm-graphql-with-react-and-apollo'" class="codeButton">Subversion</button>
                    </div>
       
                    <div class="input-group">                    
                        <!-- Target -->
                        <input id="github-url" value="git@github.com:grails-guides/gorm-graphql-with-react-and-apollo.git" type="text" />

                        <!-- Trigger -->
                        <button class="clipbtn" type="button" data-clipboard-target="#github-url">

                            <img width="13" src="../img/clippy.svg" alt="Copy to clipboard">
                        </button>       

                    </div>
                    <div class="input-group">
                      <a href="https://github.com/grails-guides/gorm-graphql-with-react-and-apollo/archive/master.zip" class="downloadButton">Download ZIP</a>
                    </div>
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically. All guides are released with an ASLv2 license for the code, and Creative Commons license for the writing. 
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
